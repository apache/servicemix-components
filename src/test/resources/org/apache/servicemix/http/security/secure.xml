<beans xmlns:sm="http://servicemix.apache.org/config/1.0"
       xmlns:http="http://servicemix.apache.org/http/1.0"
       xmlns:soap="http://servicemix.apache.org/soap/1.0"
       xmlns:ex="http://servicemix.org/example">

  <sm:container id="jbi" embedded="true" useMBeanServer="false">
    <sm:broker>
      <sm:securedBroker>
        <sm:authorizationMap>
	      <sm:authorizationMap>
	        <sm:authorizationEntries>
	          <sm:authorizationEntry service="*:*" roles="admin" />
	          <sm:authorizationEntry service="ex:receiver" roles="secure" />
	        </sm:authorizationEntries>
	      </sm:authorizationMap>
        </sm:authorizationMap>
      </sm:securedBroker>
    </sm:broker>
    
      
    <sm:activationSpecs>

	  <sm:activationSpec id="http">
	    <sm:component>
	      <http:component>
	        <http:endpoints>
	          <http:endpoint service="ex:receiver"
	                         endpoint="http"
	                         targetService="ex:receiver"
	                         role="consumer"
	                         locationURI="http://localhost:8192/Service/"
	          				 authMethod="basic" 
	          				 defaultMep="http://www.w3.org/2004/08/wsdl/in-only">
              </http:endpoint>
              <http:endpoint service="ex:receiver"
                             endpoint="http-wssec"
                             targetService="ex:receiver"
                             role="consumer"
                             locationURI="http://localhost:8192/WSSec/"
                             defaultMep="http://www.w3.org/2004/08/wsdl/in-only"
                             soap="true">
                 <http:policies>
                   <soap:ws-addressing />
                   <soap:ws-security receiveAction="UsernameToken" />
                 </http:policies>
              </http:endpoint>
	        </http:endpoints>
	      </http:component>
	    </sm:component>
	  </sm:activationSpec>

      <sm:activationSpec id="receiver" service="ex:receiver">
        <sm:component>
          <bean class="org.apache.servicemix.tck.ReceiverComponent" />
        </sm:component>
      </sm:activationSpec>

    </sm:activationSpecs>
  </sm:container>

</beans>